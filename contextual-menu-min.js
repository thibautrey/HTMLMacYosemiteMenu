function ContextualMenu(e){function n(e,t){if(e){for(var r=0;r<e.length;r++){if(e[r].id==t){return e[r]}var i=n(e[r].items,t);if(i)return i}}}var t=this;this.items=Array();this.id=e;this.acceptableSubMenuStack=Array();this.addMenuItem=function(e){this.items.push(e)};this.removeContextualMenu=function(){$("#"+this.id).remove();$(this).trigger("menuDismissed")};this.menuTrigger=function(e,n,r){$(document).on(e,n,function(e){t.removeContextualMenu();r($(e.originalEvent.target));var n=$('<div class="contextualMenu" id="'+t.id+'"><div class="contextualMenuBackground"></div><ul></ul></div>');console.log(e);n.css("left",e.pageX);n.css("top",e.pageY);for(var i=0;i<t.items.length;i++){var s=t.items[i];var o='<li id="'+s.id+'" data-parent="top">';o+=s.title;if(s.items.length){o+='<span class="pull-right subMenuCaret">&#10095;</span>'}o+="</li>";n.append($(o))}$("body").append(n)})};this.searchForItemInHierarchy=function(e){return n(this.items,e)};$(document).on("mouseover","#"+this.id+" li",function(e){var n=$(this).attr("id");var r=t.searchForItemInHierarchy(n);if($(this).attr("data-parent")!="top"){if(t.acceptableSubMenuStack.indexOf($(this).attr("data-parent"))!=-1){t.acceptableSubMenuStack.push(r.id)}else{this.acceptableSubMenuStack=Array();$("#"+t.id+" .submenu").remove()}}else{$("#"+t.id+" .submenu").remove();t.acceptableSubMenuStack=Array();t.acceptableSubMenuStack.push(r.id)}$("#"+t.id+" li[data-parent="+n+"]").remove();$("#"+t.id+" .submenu").each(function(){if(typeof $("#"+$(this).attr("data-parent"))=="undefined"){$(this).remove()}});$("#"+t.id+" ul").each(function(){if(!$(this).find("li").length){$(this).remove()}});if(r.items.length){var i=$('<div class="contextualMenu submenu" id="'+r.id+'"><div class="contextualMenuBackground"></div><ul></ul></div>');i.css("left",$(this)[0].offsetWidth+"px");i.css("top",$(this)[0].offsetTop+"px");for(var s=0;s<r.items.length;s++){var o=r.items[s];var u='<li id="'+o.id+'" data-parent="'+r.id+'">';u+=o.title;if(o.items.length){u+='<span class="pull-right subMenuCaret">&#10095;</span>'}u+="</li>";i.append($(u))}$(this).parent().append(i)}});$(document).on("click","#"+this.id+" li",function(e){var n=$(this).attr("id");$(t).trigger("menuClick",[n])});listOfContextualMenus.push(this)}function MenuItem(e,t){this.items=Array();this.title=t;this.id=e;this.addSubMenuItem=function(e){this.items.push(e)}}var listOfContextualMenus=Array();